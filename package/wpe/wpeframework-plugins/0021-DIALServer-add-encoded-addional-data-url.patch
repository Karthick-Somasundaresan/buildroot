From 400a14206ea600b2c2e21168c5d64fdfb49be20b Mon Sep 17 00:00:00 2001
From: modeveci <o.deveci@metrological.com>
Date: Sun, 11 Oct 2020 17:32:10 +0200
Subject: [PATCH 2/6] [DIALServer]: add encoded addional data url

---
 DIALServer/DIALServer.cpp | 1 +
 1 file changed, 1 insertion(+)

diff --git a/DIALServer/DIALServer.cpp b/DIALServer/DIALServer.cpp
index 11bdc36..2c90af1 100644
--- a/DIALServer/DIALServer.cpp
+++ b/DIALServer/DIALServer.cpp
@@ -401,6 +401,7 @@ namespace Plugin {
             const string additionalDataUrl = (_T("http://localhost") + ((_webServerPort.empty() == true)? _T("") : _T(":") + _webServerPort) + _T("/Service/DIALServer/Apps/") + app.Name() + _T("/") + _DefaultDataExtension);
             const uint16_t maxEncodedSize = static_cast<uint16_t>(additionalDataUrl.length() * 3 * sizeof(TCHAR));
             TCHAR* encodedDataUrl = reinterpret_cast<TCHAR*>(ALLOCA(maxEncodedSize)); 
+            Core::URL::Encode(additionalDataUrl.c_str(), static_cast<uint16_t>(additionalDataUrl.length()), encodedDataUrl, maxEncodedSize);
             string parameters = (app.AppURL() + (app.HasQueryParameter()? _T("&") : _T("?")) + _T("additionalDataUrl=") + encodedDataUrl);
 
             TRACE(Trace::Information, (_T("Launch Application [%s] with params: %s, payload: %s"), app.Name().c_str(), parameters.c_str(), payload.c_str()));
-- 
2.25.1

